# trading-singleleg
This contains set of R programs (to generate entry signals) and Java programs (to manage entry and exit) based on configurable rules using IB API. 
Programs makes use of Redis queues to monitor entry signals and hash structure to update trade information.
Complete set acts as automated trading system.

## Features

  * Generates entry trade signals at frequent interval
  * Performs trade entry based on entry signals arriving in the defined queue of Redis
  * Supports market orders and relative orders
  * Once trades are entered, keeps monitoring and take actions based on parameters/configurations, stop loss limit, take profit limits, holding period etc.
  * Exits the trades based on pre-set rules.
  * Provision to perform manual interventions (currently supports square off, adjustment of take profit limits and adjustment of stop loss limits)
  * Updates the position info in Redis Hash structure and files at regular intervals (Though monitoring is real time)
  * ...
  * ...

## Instructions

Requires following :
  * IB TWS to be running and accessible from the machine where this Java program is running.
  * Redis server to be running and accessible from the machine where this Java programs is running.
  * Predefined key structure to store configuration is available on Redis server. 'redis-configuration.txt' contains required keys.
  * Updated timeseries data of OHLCV in csv format for set of symbols on which this system operates on.

### Generating Entry Signals

Entry Signals are generated by a R program which executes a predefined Interval. Sample R program is available as 'GenSignals_10min.R'. 
This R Program expects that updated timeseries of YYYYMMDDHHMMSS, Open, High, Low, Close, Volume in csv format is available 
for given Stocks/Futures at given location. This R Program generates signal on the basis of prediction of MFE (maximum favourable exposure) 
and MAE (maximum adverse exposure) for a given holding period. Prediction is performed using existing model of MFE and MAE. R program assumes that models
are present in given location.  

### Running the programs

Please download all the files, and compile to make jar file. 
Run the jar file as follows :

	Usage : <fileName.jar> <debugFlag> <redisServerIPAddress> <redisServerPortNumber> <redisServerConfigKey> <TWSIPAddress> <TWSPortNumber> <TWSClientID> <ExchangeCurrency>

    debugFlag is debug flag. 1 is true. 0 is false
    redisServerIPAddress is ip address/machine name where Redis Server is running
    redisServerPortNumber is port number on which Redis Server is listening for connections        
    redisServerConfigKey is configKey in Redis Server to use.'redis-configuration.txt' contains required keys.  
    TWSIPAddress is ip address/machine name where TWS is running
    TWSPortNumber is port number on which TWS is listening for API calls
    TWSClientID is client id to be used for trading through IB TWS
    ExchangeCurrency is exchange currency to be used for this session. based on that timezone gets set. supported values are "inr" or "usd"

### Manually exiting the trades

For any open positions, exits (square off) can be performed manually by updating the corresponding Redis queue in predetermined Format. 
Name of the queue to be updated is same as given in redisServerConfigKey. To square off an open position at current market price, 
Redis queue needs to be updated with following info :
	YYYYMMDDHHSS,T,<slot Number of Open Position>,1,0

This can be achived using Redis-cli client.
	
## Troubleshooting

If you have problems using the software, please try to see if all pre-requisite / requirements are taken care.

## Filing an issue/Reporting a bug

When reporting bugs against `trading-singleleg`, please don't forget to include enough information :

* Is the problem happening with the latest version ?
* What operating system are you using ?
* Do you have all the recommended versions of the modules? See them in
  the file `requirements.txt`.
* What is the precise message you are getting or unexpected behavior you are experiencing ? Please, copy and paste them.
  Don't reword the messages.
  
## Feedback

I enjoy getting feedback. Please do send feedback to contacts below.

## Contact

Post bugs and issues on [github]. 
Send other comments to Manish Singh: mksingh at hotmail dotcom
